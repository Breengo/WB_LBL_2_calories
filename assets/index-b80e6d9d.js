(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))e(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function c(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(r){if(r.ep)return;r.ep=!0;const n=c(r);fetch(r.href,n)}})();let u=[],s=[],l=[],d=1e3,f=1,y=!1,S="";const O=()=>{const t=localStorage.getItem("products");t&&(u=JSON.parse(t));const o=localStorage.getItem("limit");d&&(d=o);const c=localStorage.getItem("day");c&&(s=JSON.parse(c));const e=localStorage.getItem("allDays");e&&(l=JSON.parse(e),f=l.length+1)},b=t=>{f=t},v=t=>{s=t},T=t=>{d=t},k=()=>{y=!y},w=t=>{S=t},m=()=>{const t=document.querySelector(".day_list_items");document.querySelector(".day_list_header").querySelector("h2").innerText=`День ${f}`,t.innerHTML="",s.forEach(e=>{const r=document.createElement("div");r.classList.add("day_list_item"),r.innerHTML=`
          <p>${e.name}</p>
          <p>${e.calories} к/г</p>
          <p>${e.weight} г</p>
          <p>${e.calories*e.weight} к</p>
          <button class="plus_button">-</button>
          `,t.appendChild(r)});let o=0;document.querySelectorAll(".day_list_item").forEach((e,r)=>{o+=Number(e.querySelectorAll("p")[3].innerText.replace("к","")),e.querySelector("button").addEventListener("click",()=>{s.splice(r,1),localStorage.setItem("day",JSON.stringify(s)),m()})}),document.querySelector(".day_list_footer").querySelector("p").innerText=`Итого: ${o} Калорий`},p=()=>{let t=[...u];y&&(t=t.sort((e,r)=>e.calories-r.calories)),S&&(t=t.filter(e=>e.name.toLowerCase().includes(S.toLowerCase())));const o=document.querySelector(".product_list_items");o.innerHTML="",t.forEach(e=>{const r=document.createElement("div");r.classList.add("product_list_item"),r.innerHTML=`
        <p>${e.name}</p>
        <p>${e.calories} к/г</p>
        <input class="small_input" placeholder="Грамм" type="text" />
        <button class="plus_button">+</button>
        <button class="plus_button">-</button>
        `,o.appendChild(r)}),document.querySelectorAll(".product_list_item").forEach((e,r)=>{const n=e.querySelectorAll("button");n[0].addEventListener("click",()=>{const i={name:"",calories:"",weight:""},L=e.querySelectorAll("p");i.weight=Number(e.querySelector("input").value),i.name=L[0].innerText,i.calories=Number(L[1].innerText.replace("к/г","")),e.querySelector("input").value="",s.push(i),s.reduce(($,_)=>$+_.weight*_.calories,0)>d&&alert("Вы превысили лимит калорий"),localStorage.setItem("day",JSON.stringify(s)),m()}),n[1].addEventListener("click",()=>{u.splice(r,1),localStorage.setItem("products",JSON.stringify(u)),p()})})},g=()=>{const t=document.querySelector(".all_day_list_items");t.innerHTML="",l.forEach(o=>{const c=document.createElement("div");c.classList.add("all_day_list_item"),c.innerHTML=`
          <p>День ${o.index}</p>
          <p>${o.calories} Калорий</p>
          <button>Подробнее</button>
          <button>Удалить</button>
          `,t.appendChild(c)}),document.querySelectorAll(".all_day_list_item").forEach((o,c)=>{const e=o.querySelectorAll("button");e[0].addEventListener("click",()=>{b(l[c].index),v(l[c].products),renderDayList()}),e[1].addEventListener("click",()=>{l.splice(c,1);for(let r=c;r<l.length;r++)l[r].index-=1;g(),renderGraph(),localStorage.setItem("allDays",JSON.stringify(l))})})},E=()=>{const t=document.querySelector(".graph_picture");t.innerHTML="";const o=Math.max(...l.map(c=>c.calories));l.forEach(c=>{const e=document.createElement("div");e.classList.add("graph_entity"),e.innerHTML=`
      <p>День ${c.index}</p>
      <p class="graph_entity_calories">${c.calories} к</p>`,e.style.height=`${c.calories/(o*1.1/100)}%`,t.appendChild(e)})},N=()=>{a.querySelector("p").innerText=`${d} калорий`},a=document.querySelector(".calories_limit"),I=t=>{const o=a.querySelector("button"),c=a.querySelector("input");t.preventDefault(),c.style.display="none",a.querySelector("p").style.display="inline",o.removeEventListener("click",I),T(Number(c.value)),localStorage.setItem("limit",d),N(),o.addEventListener("click",h)},h=t=>{const o=a.querySelector("button");t.preventDefault(),a.querySelector("input").style.display="block",a.querySelector("p").style.display="none",o.removeEventListener("click",h),o.addEventListener("click",I)};O();p();m();const A=document.querySelector("#add_product_button");A.addEventListener("click",t=>{t.preventDefault();let o={name:"",calories:""};document.querySelector(".product_add").querySelectorAll("input").forEach((c,e)=>{e===0&&(o.name=c.value),e===1&&(o.calories=Number(c.value))}),u.push(o),localStorage.setItem("products",JSON.stringify(u)),p()});const C=document.querySelector(".calories_limit");C.querySelector("button").addEventListener("click",h);N();g();document.querySelector(".day_list_footer").querySelector("button").addEventListener("click",()=>{const t={index:l.length+1,calories:s.reduce((o,c)=>o+c.weight*c.calories,0),products:[...s]};l.push(t),v([]),b(l.length+1),m(),g(),localStorage.setItem("allDays",JSON.stringify(l)),localStorage.removeItem("day"),E()});const D=document.querySelector(".product_list_header").querySelector("div").querySelectorAll("p")[1];D.style.cursor="pointer";D.addEventListener("click",()=>{k(),p()});const q=document.querySelector(".product_list_footer").querySelector("input");q.addEventListener("input",()=>{w(q.value),p()});E();
